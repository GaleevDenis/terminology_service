# Тестовое задание для стажировки (python)
# Разработать сервис терминологии и REST API к нему


## Технологии


*  **Python = 3.11.9**
*  **Django = 4.2.15**


### Дополнительные библиотеки:
*  **djangorestframework = 3.15.2**
*  **django-debug-toolbar = 4.4.6**
*  **drf-yasg = 1.21.7**


**Для описания и проверки API подключен swagger. Все методы и примеры использования описаны.**


## Сервис терминологии оперирует следующими объектами и их атрибутами:


**1. Справочник:**


* **Идентификатор:**  Уникальное значение справочника типа integer, создается автоматически.
* **Код:**  Код справочника (строка, максимальная длина 100 символов, не может быть пустой, уникальное значение).
* **Наименование:**  Наименование справочника (строка, максимальная длина 300 символов, не может быть пустой).
* **Описание:**  Подробное описание справочника (текст произвольной длины).


**2. Версия справочника.**


* **Идентификатор:**  Уникальное значение версии справочника типа integer, создается автоматически (не может быть пустой).
* **Идентификатор справочника:**  Идентификатор объекта "Справочник" справочник к которому относится версия справочника (не может быть пустой).
* **Версия:**  Версия справочника (строка, максимальная длина 50 символов, не может быть пустой).
* **Дата начала действия:**  Дата, когда данная версия справочника вступает в силу (не может быть пустой).


**3. Элемент справочника:**


* **Идентификатор:**  Уникальный идентификатор элемента типа integer, создается автоматически (не может быть пустой)
* **Идентификатор Версии справочника:** Идентификатор объекта "Версия справочника" версия справочника, к которому относится элемент (не может быть пустой)
* **Код элемента:**  (строка, 100 символов, не может быть пустой).
* **Значение элемента:**  (строка, 300 символов, не может быть пустой)


#### Ограничения при инициализации атрибутов (реализованы программно):


* Не может существовать более одного справочника с одинаковым значением в поле код.
* Не может существовать более одной версии с одинаковым набором значений "Идентификатор справочника" и "Версия".
* У одного справочника не может быть более одной версии с одинаковой "Датой начала".
* В одной версии справочника не может существовать более одного элемента справочника с одинаковым значением в поле код.

## API предоставляет следующие методы:
1. **Тип запроса HTTP: GET**
2. **Убрать символ "\\\" в запросах**


### **Получение списка справочников:**

* **refbooks/** - Получение списка всех справочников
* **refbooks/[?date=<\date>]** - Получение списка справочников в которых имеются версии с датой начала действия раннее или равной указанной в **date**.
* **date** - Дата начала действия версии
#### Формат ответа:
 * **id** - Идентификатор справочника
 * **code** - Код справочника
 * **name** - Наименование справочника


#### Примеры ответов:
**status 200: Удачная операция**
```
{
  "refbooks": [
    {
      "id": 1,
      "code": "1",
      "name": "Специальности медицинских работников"
    },
    {
      "id": 2,
      "code": "2",
      "name": "Справочник болезней"
    },
    {
      "id": 3,
      "code": "3",
      "name": "Список адресов"
    }
  ]
}
```
**status 400: Некорректный формат даты**
```
{
  "error": [
    "Введен некорректный формат даты - корректный формат: YYYY-MM_DD"
  ]
}
```
**status 404: Не найдены справочники**
```
{
  "not_found": [
    "Не найдены справочники"
  ],
  "not_found_2": [
    "Не найдены справочники с датой начала действия версии раннее или равной указанной"
  ]
}
```


### **Получение элементов справочника:**


* **refbooks/<\id>/elements/** - Получение элементов справочника с указанным **id**, возвращает элементы **текущей версии**.
* **refbooks/<\id>/elements/[?version=<\version>]** Получение элементов справочника с указанным **id** и **version**.


* **id** - Идентификатор справочника
* **version** - Версия справочника
* **Текущая версия** - дата начала действия которой позже всех остальных версий данного справочника, но не позже текущей даты.
#### Формат ответа:
 * **code** - Код элемента
 * **value** - Значение элемента


#### Примеры ответов:
**status 200: Удачная операция**
```
{
  "elements": [
    {
      "code": "1",
      "value": "Вирусная инфекция"
    },
    {
      "code": "2",
      "value": "Лихорадка"
    }
  ]
}
```
**status 404: Не найдены элементы**
```
{
  "not_found": [
    "Не найдены элементы указанной версии справочника"
  ],
  "not_found_2": [
    "Не найдены элементы текущей версии справочника"
  ]
}
```

### **Валидация элемента справочника:**


* **refbooks/<\id>/check_element/?code=<\code>&value=<\value>** - Валидация элемента справочника по указанному **id**, **code**, **value**, **текущей версии**
* **refbooks/<\id>/check_element/?code=<\code>&value=<\value>[&version=<\version>]** - Валидация элемента справочника по указанному **id**, **code**, **value**, **version**


* **id** - Идентификатор справочника
* **code** - Код элемента справочника
* **value** - Значение элемента справочника
* **version** - Версия справочника
* **Текущая версия** - дата начала действия которой позже всех остальных версий данного справочника, но не позже текущей даты.
#### Формат ответа:
 * **code** - Код элемента справочника
 * **value** - Значение элемента справочника


#### Примеры ответов:
**status 200: Удачная операция**
```
{
  "validation": [
    {
      "code": "3",
      "value": "Хирург"
    }
  ]
}
```
**status 404: Не найден элемент**
```
{
  "not_found": [
    "Не найден элемент"
  ]
}
```


## Административная панель


### **Список справочников:**


**Отображаемые поля:**
 * Идентификатор
 * Код
 * Наименование
 * Текущая версия
 * Дата начала действия версии


**Добавление, изменение, удаление справочников.**


**При редактировании справочника заполняются поля:** 
 * Код (строка, обязательно для заполнения)
 * Наименование (строка,обязательно для заполнения)
 * Описание (текст произвольной длинны).


**При редактировании справочника на этой же странице отображается список имеющихся версий данного справочника с возможностью редактирования.**


### **Список версий справочников:**


**Отображаемые поля:**
 * Код справочника
 * Наименование справочника
 * Версия
 * Дата начала версии.


**Добавление, изменение, удалении версии справочника**


**При редактировании версии справочника заполняются поля:** 


 * Справочник (выбор из списка)
 * Версия (строка)
 * Дата начала действия (выбор из календаря)


**При редактировании версии на этой же странице возможно редактирование элементов справочника в этой версии.**


### **Элементы справочников:**


**Отображаемые поля:**
 * Код элемента
 * Значение элемента
 * Справочник - версия


**Добавление, изменение, удалении элементов справочника**


**При редактировании элементов заполняются поля:**


 * Версия (выбор из списка "справочник-версия")
 * Код элемента (строка)
 * Значение элемента (строка).


**Язык интерфейса административной панели  - русский**